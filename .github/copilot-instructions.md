# Copilot Instructions for Diary Open Close (Web)

## このドキュメントについて

- GitHub Copilot や各種 AI ツールが本リポジトリのコンテキストを理解しやすくするためのガイドです。
- 新しい機能を実装する際はここで示す技術選定・設計方針・モジュール構成を前提にしてください。
- 不確かな点がある場合は、リポジトリのファイルを探索し、ユーザーに「こういうことですか?」と確認をするようにしてください。

## 前提条件

- 回答は必ず日本語でしてください。
- 何か大きい変更を加える場合(ToDoリスト数5つ以上)、まず何をするのか計画を立てた上で、ユーザーに「このような計画で進めようと思います。」と提案してください。この時、ユーザーから計画の修正を求められた場合は計画を修正して、再提案をしてください。

## 基本ルール

- `user-pj-ctrl.sh` というファイルはユーザー専用のファイルのため、エージェントは編集禁止です。
- シェルスクリプトが必要な場合は、新規にファイルを作成してください。
- markdown ファイル等のドキュメントを作成する場合は、`/workspace/docs/agent` というフォルダ内に整理して作成してください。

## 技術スタック概要
- フロントエンド: TypeScript,Next.js,TailwindCSS
- バックエンド: Go,Air
- データベース: PostgreSQL

## 実装ガイド

### 共通項目
- API 定義については backend/diary-oc-api/openapi.yaml を作成して一貫した API 管理を行うこと
- 機能追加時にはユニットテストを必ず実施すること
- 本環境は devcontainer で定義されたコンテナ環境となっており、postgresを直接操作することはできません。
- `psql` コマンドや `docker` コマンドは使用不可・禁止です
- devcontainer 環境では `vscode` という名前のユーザーで実行することを前提としています。

### フロントエンド関連
- any型は使用せず具体的な型を定義すること
- modalを実装する場合はmodalの周囲は透過するように実装すること
- modalの背景を透過する際のtailwindのクラス名は「bg-black/50」のような指定方法に変更されたのでそのように指定すること
- API からデータを取得して変数に代入する場合について、その変数が`null`や`undefined`の場合にエラーが発生しないように注意して実装すること

### バックエンド関連
- Go に関する開発においては、Air を使用してホットリロードができるようにすること
- Air については `vscode` ユーザーに対してインストール済み
- 本番環境のことも考えて以下の値は環境変数から設定できるようにすること
  - HOST
  - API_PORT
  - ALLOWED_ORIGINS
  - DATABASE_URL
  - JWT_SECRET
  - UPLOAD_DIR
- マイグレーションが必要になったら Go で実行できるCLIコマンドで実装すること。

## まとめ

このドキュメントを常に最新に保ち、新しい技術選定や設計変更があった場合は適宜更新してください。GitHub Copilot や AI ツールは、このドキュメントを参照することで、プロジェクトのコンテキストを正確に理解し、より適切なコード提案を行うことができます。

チーム全体でこのガイドラインに従うことで、コードの一貫性と保守性が向上し、新しいメンバーのオンボーディングも円滑になります。

---

**Diary Open Close (Web)** は、モダンな開発のベストプラクティスを取り入れた、スケーラブルで保守性の高いアーキテクチャを目指しています。
